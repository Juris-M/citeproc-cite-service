<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: ColumnTool</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: ColumnTool</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>ColumnTool<span class="signature">(opts)</span><span class="type-signature"></span></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    
    <h4 class="name" id="ColumnTool"><span class="type-signature"></span>new ColumnTool<span class="signature">(opts)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Methods for sniffing column positions
  and for accessing column content by column nickname, while
  recognizing columns in arbitrary sequence within the spreadsheet.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>opts</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">command-line options set by the `getopts` package</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line485">line 485</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="colMapHints"><span class="type-signature"></span>colMapHints<span class="type-signature"></span></h4>




<div class="description">
    A mapping of column nicknames to strings
  likely to be found in the header of each.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line528">line 528</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="checkColMap"><span class="type-signature"></span>checkColMap<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Check that all expected columns are present
  in the spreadsheet, and throw an error if they are not.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line623">line 623</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

    <div class="param-desc">
    
        a helpful error on the first column identified as missing
    
    </div>


    







        
            

    

    
    <h4 class="name" id="checkCsvFilenameSanity"><span class="type-signature"></span>checkCsvFilenameSanity<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Check that there is one and only one
  CSV file in the current directory with the form
  "data-\<country name\>.csv".
* If more than one such file exists,
  throw an appropriate error
* If no such file exists, throw a different
  appropriate error
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line505">line 505</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="getSpreadsheetArrays"><span class="type-signature"></span>getSpreadsheetArrays<span class="signature">(csvFilePath)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Read the spreadsheet file, normalize its line endings,
  and parse the content to an array of arrays. Analyze the first
  line to match columns to nicknames, and discard the headline.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>csvFilePath</code></td>
            

            <td class="type">
            
                
<span class="param-type">str</span>


            
            </td>

            

            

            <td class="description last">path to CSV file to use as input</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line663">line 663</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="ColumnTool.html#setColMap">ColumnTool#setColMap</a></li>
        
            <li><a href="ColumnTool.html#checkColMap">ColumnTool#checkColMap</a></li>
        </ul>
    </dd>
    

    
</dl>




















        
            

    

    
    <h4 class="name" id="loadLine"><span class="type-signature"></span>loadLine<span class="signature">(record)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Copy each labeled cell of a spreadsheet line
  to an object with the column nickname as its key,
  and return the object.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>record</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">an array representing one spreadsheet line</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line641">line 641</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setColMap"><span class="type-signature"></span>setColMap<span class="signature">(headline)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    For each column label in the spreadsheet
  headline, check for its match string among those corresponding
  to column nicknames. If found, add its nickname to an array
  of column nicknames. Otherwise add null to the array to flag
  it as irrelevant.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>headline</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">an array representing one spreadsheet line</td>
        </tr>

    
    </tbody>
</table>






    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>colMap</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">an array of column nicknames, in the
  order of the corresponding columns in the spreadsheet</td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="make-data.js.html">make-data.js</a>, <a href="make-data.js.html#line599">line 599</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ColumnTool.html">ColumnTool</a></li><li><a href="Compositor.html">Compositor</a></li><li><a href="SetupTool.html">SetupTool</a></li></ul><h3>Global</h3><ul><li><a href="global.html#handleError">handleError</a></li><li><a href="global.html#run">run</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Nov 28 2023 09:47:13 GMT+0900 (Japan Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>